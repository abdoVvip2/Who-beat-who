<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„Ø¹Ø¨Ø©: Ù…Ù† ÙŠÙ‡Ø²Ù… Ù…Ù†ØŸ (Ø°ÙƒØ§Ø¡ Ø§ØµØ·Ù†Ø§Ø¹ÙŠ)</title>
    <style>
        body {
            background: linear-gradient(135deg, #fdfbfb 0%, #ebedee 100%);
            font-family: Tahoma, sans-serif;
            text-align: center;
            padding: 20px;
            direction: rtl;
        }
        .header {
            background-color: #0057B8;
            color: white;
            padding: 15px;
            font-size: 24px;
            margin-bottom: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .element {
            font-size: 60px;
 Mannheim, Germany
            margin: 20px 0;
            transition: transform 0.3s;
        }
        input[type="text"] {
            padding: 10px;
            font-size: 18px;
            width: 60%;
            border-radius: 5px;
            border: 1px solid #ccc;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        button {
            padding: 10px 15px;
            font-size: 18px;
            margin-top: 10px;
            background-color: #0057B8;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #003e8c;
        }
        .result {
            font-size: 20px;
            margin-top: 20px;
            color: #333;
            min-height: 50px;
        }
        .emoji-hint {
            font-size: 24px;
            margin-top: 10px;
            color: #555;
        }
        .score {
            font-size: 18px;
            margin-top: 15px;
            color: #0057B8;
        }
    </style>
</head>
<body>
    <div class="header">Ù„Ø¹Ø¨Ø©: Ù…Ù† ÙŠÙ‡Ø²Ù… Ù…Ù†ØŸ (Ø°ÙƒØ§Ø¡ Ø§ØµØ·Ù†Ø§Ø¹ÙŠ)</div>
    <div class="element" id="currentElement">Ø§Ù„Ù…Ø·ÙˆØ±ğŸ§‘ğŸ½â€ğŸ’»</div>
    <input type="text" id="userInput" placeholder="Ø£Ø¯Ø®Ù„ Ø´ÙŠØ¦Ù‹Ø§ Ù„ÙŠÙ‡Ø²Ù… Ø§Ù„ØµØ®Ø±Ø©">
    <br>
    <button onclick="checkWithAI()">ØªØ­Ù‚Ù‚ Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</button>
    <div class="result" id="result"></div>
    <div class="emoji-hint" id="hint"></div>
    <div class="score" id="score">Ø³Ù„Ø³Ù„Ø© Ø§Ù„ÙÙˆØ² Ø§Ù„Ø­Ø§Ù„ÙŠØ©: 0 | Ø£Ø¹Ù„Ù‰ Ø³Ù„Ø³Ù„Ø©: 0</div>

    <script>
        const apiKey = 'AIzaSyDTmHB9SRj47W8KBkn1SzD7-beJRcq284E'; // Ø§Ø³ØªØ¨Ø¯Ù„ Ø¨Ù…ÙØªØ§Ø­ API ØµØ§Ù„Ø­
        const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-pro:generateContent?key=${apiKey}`;
        let current = "Ø§Ù„Ù…Ø·ÙˆØ±";
        let currentEmoji = "ğŸ§‘ğŸ½â€ğŸ’»";
        let currentStreak = 0;
        let highScore = localStorage.getItem('highScore') ? parseInt(localStorage.getItem('highScore')) : 0;
        const emojiMap = {
            "ØµØ®Ø±Ø©": "ğŸª¨",
            "ÙˆØ±Ù‚Ø©": "ğŸ“„",
            "Ù…Ù‚Øµ": "âœ‚ï¸",
            "Ù†Ø§Ø±": "ğŸ”¥",
            "Ù…Ø§Ø¡": "ğŸ’§",
            "Ù‡ÙˆØ§Ø¡": "ğŸŒ¬ï¸",
            "Ø´Ø¬Ø±Ø©": "ğŸŒ³",
            "Ø±Ø¬Ù„": "ğŸ‘¨",
            "Ø­ÙŠÙˆØ§Ù†": "ğŸ¾"
        };

        // ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª
        function updateScoreDisplay() {
            document.getElementById("score").innerHTML = `Ø³Ù„Ø³Ù„Ø© Ø§Ù„ÙÙˆØ² Ø§Ù„Ø­Ø§Ù„ÙŠØ©: ${currentStreak} | Ø£Ø¹Ù„Ù‰ Ø³Ù„Ø³Ù„Ø©: ${highScore}`;
        }

        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø¹Ø±Ø¶ Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
        updateScoreDisplay();

        function checkWithAI() {
            const input = document.getElementById("userInput").value.trim();
            const result = document.getElementById("result");
            const hint = document.getElementById("hint");
            if (!input) {
                result.innerHTML = "ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø´ÙŠØ¡!";
                return;
            }

            const userChoice = input;
            let emoji = emojiMap[userChoice] || null;

            const prompt = `Ø£Ù†Ø§ Ø£Ù‚ÙˆÙ… Ø¨Ù„Ø¹Ø¨Ø© Ø­ÙŠØ« ÙŠØ¬Ø¨ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ø®ØªÙŠØ§Ø± Ø´ÙŠØ¡ ÙŠÙ…ÙƒÙ†Ù‡ Ø§Ù„ØªØºÙ„Ø¨ Ø¹Ù„Ù‰: '${current}'. Ø¥Ø°Ø§ Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: '${userChoice}', Ù‚Ù… Ø¨Ø§Ù„ØªØ§Ù„ÙŠ:
            1. Ø­Ø¯Ø¯ Ø¥Ù† ÙƒØ§Ù† Ù‡Ø°Ø§ Ø³ÙŠÙÙˆØ² Ø£Ùˆ ÙŠØ®Ø³Ø± ÙˆÙ„Ù…Ø§Ø°Ø§ØŒ Ø¨Ø¬Ù…Ù„Ø© Ù…Ù† 1 Ø¥Ù„Ù‰ 3 Ø£Ø³Ø·Ø±ØŒ Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©.
            2. Ø§Ù‚ØªØ±Ø­ Ø¥ÙŠÙ…ÙˆØ¬ÙŠ Ù…Ù†Ø§Ø³Ø¨ Ù„Ù€ '${userChoice}'. Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø´Ø§Ø¨Ù‡Ù‹Ø§ Ù„Ø¹Ù†ØµØ± Ù…Ø¹Ø±ÙˆÙ (Ù…Ø«Ù„ "Ø­ØµØ§Ø©" Ù…Ø´Ø§Ø¨Ù‡ Ù„Ù€ "ØµØ®Ø±Ø©")ØŒ Ø§Ø³ØªØ®Ø¯Ù… Ø¥ÙŠÙ…ÙˆØ¬ÙŠ Ø§Ù„Ø¹Ù†ØµØ± Ø§Ù„Ø£Ù‚Ø±Ø¨ (Ù…Ø«Ù„ ğŸª¨ Ù„Ù€ "Ø­ØµØ§Ø©").
            Ø§Ù„Ø±Ø¯ Ø¨ØµÙŠØºØ©: "Ø§Ù„Ù†ØªÙŠØ¬Ø©: [Ø§Ù„Ù†Øµ]. Ø§Ù„ÙÙˆØ²: [ØµØ­ÙŠØ­/Ø®Ø·Ø£]. Ø§Ù„Ø¥ÙŠÙ…ÙˆØ¬ÙŠ: [Ø§Ù„Ø¥ÙŠÙ…ÙˆØ¬ÙŠ]"`;

            result.innerHTML = "Ø¬Ø§Ø±Ù Ø§Ù„ØªÙÙƒÙŠØ±...";

            fetch(url, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
            })
                .then(res => {
                    if (!res.ok) {
                        throw new Error(`Ø®Ø·Ø£ HTTP! Ø§Ù„Ø­Ø§Ù„Ø©: ${res.status}`);
                    }
                    return res.json();
                })
                .then(data => {
                    console.log("API Response:", data); // Ù„Ù„ØªØµØ­ÙŠØ­
                    if (!data?.candidates?.[0]?.content?.parts?.[0]?.text) {
                        throw new Error("Ø§Ø³ØªØ¬Ø§Ø¨Ø© API ØºÙŠØ± ØµØ§Ù„Ø­Ø© Ø£Ùˆ ÙØ§Ø±ØºØ©.");
                    }

                    const responseText = data.candidates[0].content.parts[0].text;
                    let responseParts = responseText.split('Ø§Ù„Ø¥ÙŠÙ…ÙˆØ¬ÙŠ:');
                    let resultParts = responseParts[0].split('Ø§Ù„ÙÙˆØ²:');
                    let resultText = resultParts[0].replace('Ø§Ù„Ù†ØªÙŠØ¬Ø©:', '').trim();
                    let isWin = resultParts[1]?.trim() === 'ØµØ­ÙŠØ­';
                    let suggestedEmoji = responseParts[1]?.trim() || emoji || "â“";

                    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª
                    if (isWin) {
                        currentStreak++;
                        if (currentStreak > highScore) {
                            highScore = currentStreak;
                            localStorage.setItem('highScore', highScore);
                        }
                    } else {
                        currentStreak = 0;
                    }
                    updateScoreDisplay();

                    // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                    document.getElementById("currentElement").innerHTML = suggestedEmoji + ' ' + userChoice;
                    current = userChoice;
                    currentEmoji = suggestedEmoji;

                    result.innerHTML = resultText;
                    hint.innerHTML = `Ø§Ø®ØªØ± Ø´ÙŠØ¦Ù‹Ø§ Ø£Ù‚ÙˆÙ‰ Ù…Ù† ${userChoice}`;
                    document.getElementById("userInput").value = "";
                })
                .catch(err => {
                    console.error("Error:", err);
                    result.innerHTML = `Ø­Ø¯Ø« Ø®Ø·Ø£: ${err.message}. ØªØ­Ù‚Ù‚ Ù…Ù† Ù…ÙØªØ§Ø­ API Ø£Ùˆ Ø§ØªØµØ§Ù„ Ø§Ù„Ø´Ø¨ÙƒØ©.`;
                });
        }
    </script>
</body>
</html>